<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tools for ASV Data Analysis • asvtools</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Tools for ASV Data Analysis">
<meta name="description" content="A suite of functions for filtering and manipulating Amplicon Sequence Variant (ASV) data, commonly used in microbiome and environmental sequencing studies. It includes tools for applying various abundance and prevalence filters, facilitating downstream analysis.">
<meta property="og:description" content="A suite of functions for filtering and manipulating Amplicon Sequence Variant (ASV) data, commonly used in microbiome and environmental sequencing studies. It includes tools for applying various abundance and prevalence filters, facilitating downstream analysis.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">asvtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/filtering-asvs.html">Filtering ASV Data with asvtools</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="asvtools">asvtools<a class="anchor" aria-label="anchor" href="#asvtools"></a>
</h1></div>
<p>The goal of asvtools is to provide a robust and flexible way to filter Amplicon Sequence Variants (ASVs) based on multiple biological and statistical criteria, which is a common and crucial step in microbiome data analysis.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <strong>asvtools</strong> from <a href="https://github.com/GaoYangxx/asvtools" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"GaoYangxx/asvtools"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using GitHub PAT from the git credential store.</span></span>
<span><span class="co">#&gt; Downloading GitHub repo GaoYangxx/asvtools@HEAD</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── R CMD build ─────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;          checking for file 'C:\Users\Gao Yang\AppData\Local\Temp\RtmpSSzSAg\remotes7e38d1b39b6\GaoYangxx-asvtools-25f30aa/DESCRIPTION' ...  ✔  checking for file 'C:\Users\Gao Yang\AppData\Local\Temp\RtmpSSzSAg\remotes7e38d1b39b6\GaoYangxx-asvtools-25f30aa/DESCRIPTION'</span></span>
<span><span class="co">#&gt;       ─  preparing 'asvtools':</span></span>
<span><span class="co">#&gt;    checking DESCRIPTION meta-information ...     checking DESCRIPTION meta-information ...   ✔  checking DESCRIPTION meta-information</span></span>
<span><span class="co">#&gt;       ─  checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">#&gt;   ─  checking for empty or unneeded directories</span></span>
<span><span class="co">#&gt;       ─  building 'asvtools_0.0.0.9000.tar.gz'</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Installing package into 'C:/Users/Gao Yang/AppData/Local/Temp/Rtmpo94r89/temp_libpath7a8c291a1b96'</span></span>
<span><span class="co">#&gt; (as 'lib' is unspecified)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gaoyangxx.github.io/asvtools/">asvtools</a></span><span class="op">)</span> <span class="co"># load the package</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The filter_asvs() function is designed to apply a series of common filtering steps to ASV count data. It allows for highly customizable filtering based on absolute abundance, relative abundance, and presence across samples and biological groups.</p>
<div class="section level3">
<h3 id="filter_asvs-function-overview">
<code>filter_asvs()</code> Function Overview<a class="anchor" aria-label="anchor" href="#filter_asvs-function-overview"></a>
</h3>
<p>This function filters ASVs based on four conditions, which can be combined or used individually:</p>
<p>1.Minimum Sample Presence (Absolute Abundance &gt; 0): An ASV must be detected (count &gt; 0) in at least min_samples_present samples.</p>
<p>2.Minimum Absolute Abundance Value: In at least min_samples_present samples, the ASV’s absolute count must be greater than or equal to min_abs_abundance_value. Note that min_samples_present applies to both the “count &gt; 0” and “count &gt;= value” criteria.</p>
<p>3.(Optional) Minimum Group Presence: If metadata_df and group_column_name are provided, an ASV must be present (absolute abundance &gt; 0) in at least min_groups_present distinct biological groups defined by the specified column in the metadata.</p>
<p>4.Minimum Overall Average Relative Abundance: The ASV’s average relative abundance across all samples must be greater than or equal to min_overall_avg_rel_abundance.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Create dummy ASV count data ---</span></span>
<span><span class="co"># This small example data allows for clear demonstration of filtering effects.</span></span>
<span><span class="co"># Note: In a real scenario, you would load your actual ASV table and metadata.</span></span>
<span><span class="va">ASVs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  JRG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">33</span>, <span class="fl">0</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">44</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">46</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">28</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">0</span>, <span class="fl">83</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JJG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">49</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">28</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">48</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">105</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">44</span>, <span class="fl">62</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>  JJG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">64</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">26</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">23</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">155</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">52</span>, <span class="fl">79</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>  JJG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">45</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">30</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">26</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">213</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">59</span>, <span class="fl">51</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  JJG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">31</span>, <span class="fl">56</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">24</span>, <span class="fl">37</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">0</span>, <span class="fl">65</span>, <span class="fl">41</span>, <span class="fl">0</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">37</span>, <span class="fl">81</span>, <span class="fl">19</span><span class="op">)</span>,</span>
<span>  JJG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">24</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">66</span>, <span class="fl">55</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">111</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">62</span>, <span class="fl">44</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  JJG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">34</span>, <span class="fl">102</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">57</span>, <span class="fl">37</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  TZG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">16</span>, <span class="fl">20</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">224</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>  TZG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">49</span>, <span class="fl">0</span>, <span class="fl">61</span>, <span class="fl">52</span>, <span class="fl">24</span>, <span class="fl">88</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  TZG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">39</span>, <span class="fl">12</span>, <span class="fl">121</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">26</span>, <span class="fl">15</span>, <span class="fl">26</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">76</span>, <span class="fl">87</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">61</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  TZG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">66</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  TZG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">53</span>, <span class="fl">0</span>, <span class="fl">103</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">63</span>, <span class="fl">32</span>, <span class="fl">24</span>, <span class="fl">142</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  TZG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>  PAG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">122</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">122</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">79</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">428</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">18</span>, <span class="fl">598</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">161</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">42</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASV33223"</span>, <span class="st">"ASV25409"</span>, <span class="st">"ASV28883"</span>, <span class="st">"ASV70267"</span>, <span class="st">"ASV48196"</span>, <span class="st">"ASV40031"</span>, <span class="st">"ASV65646"</span>, <span class="st">"ASV8421"</span>, <span class="st">"ASV58120"</span>, <span class="st">"ASV52240"</span>, <span class="st">"ASV16749"</span>, <span class="st">"ASV14431"</span>, <span class="st">"ASV75284"</span>, <span class="st">"ASV29542"</span>, <span class="st">"ASV59240"</span>, <span class="st">"ASV71098"</span>, <span class="st">"ASV11980"</span>, <span class="st">"ASV34954"</span>, <span class="st">"ASV43989"</span>, <span class="st">"ASV16613"</span>, <span class="st">"ASV201"</span>, <span class="st">"ASV138"</span>, <span class="st">"ASV11736"</span>, <span class="st">"ASV207"</span>, <span class="st">"ASV323"</span>, <span class="st">"ASV4139"</span>, <span class="st">"ASV4011"</span>, <span class="st">"ASV6667"</span>, <span class="st">"ASV317"</span>, <span class="st">"ASV11791"</span>, <span class="st">"ASV712"</span>, <span class="st">"ASV6543"</span>, <span class="st">"ASV14"</span>, <span class="st">"ASV6519"</span>, <span class="st">"ASV3823"</span>, <span class="st">"ASV3800"</span>, <span class="st">"ASV5338"</span>, <span class="st">"ASV105"</span>, <span class="st">"ASV117"</span>, <span class="st">"ASV337"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Create dummy metadata ---</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Sample.ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG_1"</span>, <span class="st">"JRG_2"</span>, <span class="st">"JRG_3"</span>, <span class="st">"JRG_4"</span>, <span class="st">"JRG_5"</span>, <span class="st">"JRG_6"</span>, <span class="st">"JJG_1"</span>, <span class="st">"JJG_2"</span>, <span class="st">"JJG_3"</span>, <span class="st">"JJG_4"</span>, <span class="st">"JJG_5"</span>, <span class="st">"JJG_6"</span>, <span class="st">"TZG_1"</span>, <span class="st">"TZG_2"</span>, <span class="st">"TZG_3"</span>, <span class="st">"TZG_4"</span>, <span class="st">"TZG_5"</span>, <span class="st">"TZG_6"</span>, <span class="st">"PAG_1"</span>, <span class="st">"PAG_2"</span>, <span class="st">"PAG_3"</span>, <span class="st">"PAG_4"</span>, <span class="st">"PAG_5"</span>, <span class="st">"PAG_6"</span><span class="op">)</span>,</span>
<span>  Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span><span class="op">)</span>,</span>
<span>  Origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span><span class="op">)</span>,</span>
<span>  Niche <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG_1"</span>, <span class="st">"JRG_2"</span>, <span class="st">"JRG_3"</span>, <span class="st">"JRG_4"</span>, <span class="st">"JRG_5"</span>, <span class="st">"JRG_6"</span>, <span class="st">"JJG_1"</span>, <span class="st">"JJG_2"</span>, <span class="st">"JJG_3"</span>, <span class="st">"JJG_4"</span>, <span class="st">"JJG_5"</span>, <span class="st">"JJG_6"</span>, <span class="st">"TZG_1"</span>, <span class="st">"TZG_2"</span>, <span class="st">"TZG_3"</span>, <span class="st">"TZG_4"</span>, <span class="st">"TZG_5"</span>, <span class="st">"TZG_6"</span>, <span class="st">"PAG_1"</span>, <span class="st">"PAG_2"</span>, <span class="st">"PAG_3"</span>, <span class="st">"PAG_4"</span>, <span class="st">"PAG_5"</span>, <span class="st">"PAG_6"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Important for character columns</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-1-basic-filtering-by-sample-presence-and-absolute-abundance">Example 1: Basic Filtering by Sample Presence and Absolute Abundance<a class="anchor" aria-label="anchor" href="#example-1-basic-filtering-by-sample-presence-and-absolute-abundance"></a>
</h3>
<p>Let’s filter for ASVs present in at least 3 samples, with an absolute abundance of at least 5 in those samples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gaoyangxx.github.io/asvtools/">asvtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">filtered_asvs_basic</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">ASVs</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; No `metadata_df` or `group_column_name` provided; skipping group-based filtering.</span></span>
<span><span class="co">#&gt; After filtering by multiple criteria, 20 ASVs were retained.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Filtered ASVs (min_samples_present=3, min_abs_abundance_value=5):"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Filtered ASVs (min_samples_present=3, min_abs_abundance_value=5):"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_basic</span><span class="op">)</span></span>
<span><span class="co">#&gt;          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">#&gt; ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">#&gt; ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">#&gt; ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">#&gt; ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">#&gt; ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">#&gt; ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">#&gt; ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">#&gt; ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">#&gt; ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">#&gt; ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">#&gt; ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">#&gt; ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">#&gt; ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">#&gt; ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">#&gt;          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">#&gt; ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">#&gt; ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">#&gt; ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">#&gt; ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">#&gt; ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">#&gt; ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">#&gt; ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">#&gt;          PAG_5 PAG_6</span></span>
<span><span class="co">#&gt; ASV201       0     0</span></span>
<span><span class="co">#&gt; ASV138      11     9</span></span>
<span><span class="co">#&gt; ASV11736     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    36</span></span>
<span><span class="co">#&gt; ASV323       0     0</span></span>
<span><span class="co">#&gt; ASV4139      0     0</span></span>
<span><span class="co">#&gt; ASV4011     11     9</span></span>
<span><span class="co">#&gt; ASV6667     18     0</span></span>
<span><span class="co">#&gt; ASV317     598   161</span></span>
<span><span class="co">#&gt; ASV11791     0     0</span></span>
<span><span class="co">#&gt; ASV712       0     0</span></span>
<span><span class="co">#&gt; ASV6543      0     0</span></span>
<span><span class="co">#&gt; ASV14        0     0</span></span>
<span><span class="co">#&gt; ASV6519      0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    29</span></span>
<span><span class="co">#&gt; ASV3800     34    23</span></span>
<span><span class="co">#&gt; ASV5338      0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0</span></span>
<span><span class="co">#&gt; ASV117       0    42</span></span>
<span><span class="co">#&gt; ASV337       0     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-combining-all-criteria-including-group-based-filtering">Example 2: Combining All Criteria, Including Group-based Filtering<a class="anchor" aria-label="anchor" href="#example-2-combining-all-criteria-including-group-based-filtering"></a>
</h3>
<p>Now, let’s add filtering by biological groups and overall relative abundance. We want ASVs that meet:</p>
<p>1.Present in at least 3 samples (absolute abundance &gt; 0).</p>
<p>2.Absolute abundance &gt;= 5 in at least 3 samples.</p>
<p>3.Present in at least 2 distinct Groups.</p>
<p>4.Overall average relative abundance &gt;= 0.001 (0.1%).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gaoyangxx.github.io/asvtools/">asvtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">filtered_asvs_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">ASVs</span>,</span>
<span>  metadata_df <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>  group_column_name <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_groups_present <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Requires ASV presence in at least 2 distinct groups</span></span>
<span>  min_overall_avg_rel_abundance <span class="op">=</span> <span class="fl">0.001</span> <span class="co"># Overall average relative abundance</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; After filtering by multiple criteria, 20 ASVs were retained.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Filtered ASVs (all combined criteria):"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Filtered ASVs (all combined criteria):"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_full</span><span class="op">)</span></span>
<span><span class="co">#&gt;          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">#&gt; ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">#&gt; ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">#&gt; ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">#&gt; ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">#&gt; ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">#&gt; ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">#&gt; ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">#&gt; ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">#&gt; ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">#&gt; ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">#&gt; ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">#&gt; ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">#&gt; ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">#&gt; ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">#&gt;          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">#&gt; ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">#&gt; ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">#&gt; ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">#&gt; ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">#&gt; ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">#&gt; ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">#&gt; ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">#&gt;          PAG_5 PAG_6</span></span>
<span><span class="co">#&gt; ASV201       0     0</span></span>
<span><span class="co">#&gt; ASV138      11     9</span></span>
<span><span class="co">#&gt; ASV11736     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    36</span></span>
<span><span class="co">#&gt; ASV323       0     0</span></span>
<span><span class="co">#&gt; ASV4139      0     0</span></span>
<span><span class="co">#&gt; ASV4011     11     9</span></span>
<span><span class="co">#&gt; ASV6667     18     0</span></span>
<span><span class="co">#&gt; ASV317     598   161</span></span>
<span><span class="co">#&gt; ASV11791     0     0</span></span>
<span><span class="co">#&gt; ASV712       0     0</span></span>
<span><span class="co">#&gt; ASV6543      0     0</span></span>
<span><span class="co">#&gt; ASV14        0     0</span></span>
<span><span class="co">#&gt; ASV6519      0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    29</span></span>
<span><span class="co">#&gt; ASV3800     34    23</span></span>
<span><span class="co">#&gt; ASV5338      0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0</span></span>
<span><span class="co">#&gt; ASV117       0    42</span></span>
<span><span class="co">#&gt; ASV337       0     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-skipping-group-based-filtering">Example 3: Skipping Group-based Filtering<a class="anchor" aria-label="anchor" href="#example-3-skipping-group-based-filtering"></a>
</h3>
<p>If you do not provide metadata_df or group_column_name, the group-based filtering criterion is skipped, and a message will be displayed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gaoyangxx.github.io/asvtools/">asvtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">filtered_asvs_no_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">ASVs</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_overall_avg_rel_abundance <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; No `metadata_df` or `group_column_name` provided; skipping group-based filtering.</span></span>
<span><span class="co">#&gt; After filtering by multiple criteria, 20 ASVs were retained.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Filtered ASVs (no group filtering):"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Filtered ASVs (no group filtering):"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_no_group</span><span class="op">)</span></span>
<span><span class="co">#&gt;          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">#&gt; ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">#&gt; ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">#&gt; ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">#&gt; ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">#&gt; ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">#&gt; ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">#&gt; ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">#&gt; ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">#&gt; ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">#&gt; ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">#&gt; ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">#&gt; ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">#&gt; ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">#&gt; ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">#&gt;          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">#&gt; ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">#&gt; ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">#&gt; ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">#&gt; ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">#&gt; ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">#&gt; ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">#&gt; ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">#&gt; ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">#&gt; ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">#&gt; ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">#&gt;          PAG_5 PAG_6</span></span>
<span><span class="co">#&gt; ASV201       0     0</span></span>
<span><span class="co">#&gt; ASV138      11     9</span></span>
<span><span class="co">#&gt; ASV11736     0     0</span></span>
<span><span class="co">#&gt; ASV207       0    36</span></span>
<span><span class="co">#&gt; ASV323       0     0</span></span>
<span><span class="co">#&gt; ASV4139      0     0</span></span>
<span><span class="co">#&gt; ASV4011     11     9</span></span>
<span><span class="co">#&gt; ASV6667     18     0</span></span>
<span><span class="co">#&gt; ASV317     598   161</span></span>
<span><span class="co">#&gt; ASV11791     0     0</span></span>
<span><span class="co">#&gt; ASV712       0     0</span></span>
<span><span class="co">#&gt; ASV6543      0     0</span></span>
<span><span class="co">#&gt; ASV14        0     0</span></span>
<span><span class="co">#&gt; ASV6519      0     0</span></span>
<span><span class="co">#&gt; ASV3823      0    29</span></span>
<span><span class="co">#&gt; ASV3800     34    23</span></span>
<span><span class="co">#&gt; ASV5338      0     0</span></span>
<span><span class="co">#&gt; ASV105       0     0</span></span>
<span><span class="co">#&gt; ASV117       0    42</span></span>
<span><span class="co">#&gt; ASV337       0     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="error-handling">Error Handling<a class="anchor" aria-label="anchor" href="#error-handling"></a>
</h2>
<p>The function includes checks for common input issues:</p>
<p>1.asv_counts_df must be a data frame with non-NULL row and column names.</p>
<p>2.If metadata_df is provided, it must be a data frame with non-NULL row names (which are expected to be sample IDs) and at least one column.</p>
<p>3.If group_column_name is provided, it must exist in metadata_df.</p>
<p>4.A warning will be issued if some samples in asv_counts_df columns cannot be matched to metadata_df row names.</p>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>asv_counts_df</code></td>
<td>A data frame of ASV counts (rows = ASVs, columns = samples).</td>
</tr>
<tr class="even">
<td><code>metadata_df</code></td>
<td>Optional. Metadata with sample info.</td>
</tr>
<tr class="odd">
<td><code>group_column_name</code></td>
<td>Column name in metadata for biological grouping.</td>
</tr>
<tr class="even">
<td><code>min_samples_present</code></td>
<td>Minimum number of samples an ASV must appear in.</td>
</tr>
<tr class="odd">
<td><code>min_abs_abundance_value</code></td>
<td>Minimum absolute count threshold per sample.</td>
</tr>
<tr class="even">
<td><code>min_groups_present</code></td>
<td>Optional. Minimum number of groups ASV must appear in.</td>
</tr>
<tr class="odd">
<td><code>min_overall_avg_rel_abundance</code></td>
<td>Minimum overall average relative abundance.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing asvtools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yang Gao <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yang Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
