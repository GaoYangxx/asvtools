<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Filtering ASV Data with asvtools • asvtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filtering ASV Data with asvtools">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">asvtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/filtering-asvs.html">Filtering ASV Data with asvtools</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filtering ASV Data with asvtools</h1>
            
      

      <div class="d-none name"><code>filtering-asvs.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the asvtools package to use its functions in the vignette</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gaoyangxx.github.io/asvtools/">asvtools</a></span><span class="op">)</span></span>
<span><span class="co"># Load other packages required for example data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="filtering-asv-data-with-asvtools">Filtering ASV Data with asvtools<a class="anchor" aria-label="anchor" href="#filtering-asv-data-with-asvtools"></a>
</h2>
<p>This vignette guides you on how to effectively filter Amplicon
Sequence Variant (ASV) data using the asvtools package. Filtering is a
crucial step in microbiome data analysis, helping to remove noise,
reduce computational burden, and significantly improve the quality of
downstream analyses.</p>
<p>The filter_asvs() function offers flexible criteria, allowing you to
precisely control which ASVs are retained based on your project’s
specific needs.</p>
</div>
<div class="section level2">
<h2 id="understanding-filter_asvs-filtering-criteria">Understanding filter_asvs() Filtering Criteria<a class="anchor" aria-label="anchor" href="#understanding-filter_asvs-filtering-criteria"></a>
</h2>
<p>The filter_asvs() function retains ASVs based on a combination of up
to four configurable conditions:</p>
<p>1.Minimum Sample Prevalence (min_samples_present): An ASV must be
present (absolute abundance &gt; 0) in at least a specified number of
samples.</p>
<p>2.Minimum Absolute Abundance Value (min_abs_abundance_value): In
samples where an ASV is present, its absolute abundance must be greater
than or equal to this threshold for the ASV to be considered “present”
for this specific condition.</p>
<p>3.Minimum Group Prevalence (min_groups_present) (Optional): If
metadata and a grouping column are provided, an ASV must be present
(absolute abundance &gt; 0) in at least a specified number of unique
groups defined by the group_column_name.</p>
<p>4.Minimum Overall Average Relative Abundance
(min_overall_avg_rel_abundance): The ASV’s overall average relative
abundance across all samples must be greater than or equal to this
threshold.</p>
<p>An ASV must satisfy all specified conditions to be retained.</p>
</div>
<div class="section level2">
<h2 id="preparing-example-data">Preparing Example Data<a class="anchor" aria-label="anchor" href="#preparing-example-data"></a>
</h2>
<p>To illustrate the filtering process, we’ll create a small, simulated
ASV count table and sample metadata. In a real-world analysis, you would
load your own experimental data.</p>
</div>
<div class="section level2">
<h2 id="create-a-dummy-asv-count-table">Create a dummy ASV count table<a class="anchor" aria-label="anchor" href="#create-a-dummy-asv-count-table"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asv_table_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  JRG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">33</span>, <span class="fl">0</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">44</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">46</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">28</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">0</span>, <span class="fl">83</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JRG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  JJG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">49</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">28</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">48</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">105</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">44</span>, <span class="fl">62</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>  JJG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">64</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">26</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">23</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">155</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">52</span>, <span class="fl">79</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>  JJG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">45</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">30</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">26</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">213</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">59</span>, <span class="fl">51</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  JJG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">31</span>, <span class="fl">56</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">24</span>, <span class="fl">37</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">0</span>, <span class="fl">65</span>, <span class="fl">41</span>, <span class="fl">0</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">37</span>, <span class="fl">81</span>, <span class="fl">19</span><span class="op">)</span>,</span>
<span>  JJG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">24</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">66</span>, <span class="fl">55</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">111</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">62</span>, <span class="fl">44</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  JJG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">33</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">34</span>, <span class="fl">102</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">57</span>, <span class="fl">37</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  TZG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">16</span>, <span class="fl">20</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">224</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>  TZG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">18</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">49</span>, <span class="fl">0</span>, <span class="fl">61</span>, <span class="fl">52</span>, <span class="fl">24</span>, <span class="fl">88</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  TZG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">39</span>, <span class="fl">12</span>, <span class="fl">121</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">26</span>, <span class="fl">15</span>, <span class="fl">26</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">76</span>, <span class="fl">87</span>, <span class="fl">37</span>, <span class="fl">0</span>, <span class="fl">61</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  TZG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">14</span>, <span class="fl">0</span>, <span class="fl">31</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">66</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  TZG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">53</span>, <span class="fl">0</span>, <span class="fl">103</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">63</span>, <span class="fl">32</span>, <span class="fl">24</span>, <span class="fl">142</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  TZG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">43</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>  PAG_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">122</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">23</span>, <span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">122</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">79</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">41</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">428</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">38</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">18</span>, <span class="fl">598</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">34</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  PAG_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">0</span>, <span class="fl">161</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">42</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASV33223"</span>, <span class="st">"ASV25409"</span>, <span class="st">"ASV28883"</span>, <span class="st">"ASV70267"</span>, <span class="st">"ASV48196"</span>, <span class="st">"ASV40031"</span>, <span class="st">"ASV65646"</span>, <span class="st">"ASV8421"</span>, <span class="st">"ASV58120"</span>, <span class="st">"ASV52240"</span>, <span class="st">"ASV16749"</span>, <span class="st">"ASV14431"</span>, <span class="st">"ASV75284"</span>, <span class="st">"ASV29542"</span>, <span class="st">"ASV59240"</span>, <span class="st">"ASV71098"</span>, <span class="st">"ASV11980"</span>, <span class="st">"ASV34954"</span>, <span class="st">"ASV43989"</span>, <span class="st">"ASV16613"</span>, <span class="st">"ASV201"</span>, <span class="st">"ASV138"</span>, <span class="st">"ASV11736"</span>, <span class="st">"ASV207"</span>, <span class="st">"ASV323"</span>, <span class="st">"ASV4139"</span>, <span class="st">"ASV4011"</span>, <span class="st">"ASV6667"</span>, <span class="st">"ASV317"</span>, <span class="st">"ASV11791"</span>, <span class="st">"ASV712"</span>, <span class="st">"ASV6543"</span>, <span class="st">"ASV14"</span>, <span class="st">"ASV6519"</span>, <span class="st">"ASV3823"</span>, <span class="st">"ASV3800"</span>, <span class="st">"ASV5338"</span>, <span class="st">"ASV105"</span>, <span class="st">"ASV117"</span>, <span class="st">"ASV337"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-dummy-sample-metadata">Create dummy sample metadata<a class="anchor" aria-label="anchor" href="#create-dummy-sample-metadata"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadata_df_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Sample.ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG_1"</span>, <span class="st">"JRG_2"</span>, <span class="st">"JRG_3"</span>, <span class="st">"JRG_4"</span>, <span class="st">"JRG_5"</span>, <span class="st">"JRG_6"</span>, <span class="st">"JJG_1"</span>, <span class="st">"JJG_2"</span>, <span class="st">"JJG_3"</span>, <span class="st">"JJG_4"</span>, <span class="st">"JJG_5"</span>, <span class="st">"JJG_6"</span>, <span class="st">"TZG_1"</span>, <span class="st">"TZG_2"</span>, <span class="st">"TZG_3"</span>, <span class="st">"TZG_4"</span>, <span class="st">"TZG_5"</span>, <span class="st">"TZG_6"</span>, <span class="st">"PAG_1"</span>, <span class="st">"PAG_2"</span>, <span class="st">"PAG_3"</span>, <span class="st">"PAG_4"</span>, <span class="st">"PAG_5"</span>, <span class="st">"PAG_6"</span><span class="op">)</span>,</span>
<span>  Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JRG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"JJG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"TZG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span>, <span class="st">"PAG"</span><span class="op">)</span>,</span>
<span>  Origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JR"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"JJ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"TZ"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span>, <span class="st">"PA"</span><span class="op">)</span>,</span>
<span>  Niche <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JRG_1"</span>, <span class="st">"JRG_2"</span>, <span class="st">"JRG_3"</span>, <span class="st">"JRG_4"</span>, <span class="st">"JRG_5"</span>, <span class="st">"JRG_6"</span>, <span class="st">"JJG_1"</span>, <span class="st">"JJG_2"</span>, <span class="st">"JJG_3"</span>, <span class="st">"JJG_4"</span>, <span class="st">"JJG_5"</span>, <span class="st">"JJG_6"</span>, <span class="st">"TZG_1"</span>, <span class="st">"TZG_2"</span>, <span class="st">"TZG_3"</span>, <span class="st">"TZG_4"</span>, <span class="st">"TZG_5"</span>, <span class="st">"TZG_6"</span>, <span class="st">"PAG_1"</span>, <span class="st">"PAG_2"</span>, <span class="st">"PAG_3"</span>, <span class="st">"PAG_4"</span>, <span class="st">"PAG_5"</span>, <span class="st">"PAG_6"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>#Applying Filtering: Examples Now, let’s demonstrate how to use the
filter_asvs() function with different filtering strategies.</p>
<p>Example 1: Basic Filtering (Prevalence and Absolute Abundance) We’ll
start by removing ASVs that are present in fewer than 3 samples, or
whose absolute abundance in present samples is less than 5.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"--- Original ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">asv_table_example</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --- Original ASV Count: 40 ---</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_asvs_basic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">asv_table_example</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No `metadata_df` or `group_column_name` provided; skipping group-based filtering.</span></span></code></pre>
<pre><code><span><span class="co">## Retained 20 ASVs after applying all filtering conditions.</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n--- Filtered ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtered_asvs_basic</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## --- Filtered ASV Count: 20 ---</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_basic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">## ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">## ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">## ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">## ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">## ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">## ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">## ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">## ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">## ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">## ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">## ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">## ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">## ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">## ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">## ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">## ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">##          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">## ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">## ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">## ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">## ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">## ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">## ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">## ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">## ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">## ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">## ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">## ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">## ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">## ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">## ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">##          PAG_5 PAG_6</span></span>
<span><span class="co">## ASV201       0     0</span></span>
<span><span class="co">## ASV138      11     9</span></span>
<span><span class="co">## ASV11736     0     0</span></span>
<span><span class="co">## ASV207       0    36</span></span>
<span><span class="co">## ASV323       0     0</span></span>
<span><span class="co">## ASV4139      0     0</span></span>
<span><span class="co">## ASV4011     11     9</span></span>
<span><span class="co">## ASV6667     18     0</span></span>
<span><span class="co">## ASV317     598   161</span></span>
<span><span class="co">## ASV11791     0     0</span></span>
<span><span class="co">## ASV712       0     0</span></span>
<span><span class="co">## ASV6543      0     0</span></span>
<span><span class="co">## ASV14        0     0</span></span>
<span><span class="co">## ASV6519      0     0</span></span>
<span><span class="co">## ASV3823      0    29</span></span>
<span><span class="co">## ASV3800     34    23</span></span>
<span><span class="co">## ASV5338      0     0</span></span>
<span><span class="co">## ASV105       0     0</span></span>
<span><span class="co">## ASV117       0    42</span></span>
<span><span class="co">## ASV337       0     0</span></span></code></pre>
<p>Example 2: Filtering with Group Prevalence Here, we introduce
metadata_df and group_column_name to add a condition that ASVs must be
present in at least 2 distinct Groups.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"--- Original ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">asv_table_example</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --- Original ASV Count: 40 ---</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_asvs_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">asv_table_example</span>,</span>
<span>  metadata_df <span class="op">=</span> <span class="va">metadata_df_example</span>,</span>
<span>  group_column_name <span class="op">=</span> <span class="st">"Group"</span>, <span class="co"># Use the 'Group' column from metadata for grouping</span></span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_groups_present <span class="op">=</span> <span class="fl">2</span> <span class="co"># ASV must be present in at least 2 distinct 'Group's</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Retained 20 ASVs after applying all filtering conditions.</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n--- Filtered ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtered_asvs_group</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## --- Filtered ASV Count: 20 ---</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_group</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">## ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">## ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">## ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">## ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">## ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">## ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">## ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">## ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">## ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">## ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">## ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">## ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">## ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">## ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">## ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">## ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">##          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">## ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">## ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">## ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">## ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">## ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">## ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">## ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">## ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">## ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">## ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">## ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">## ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">## ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">## ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">##          PAG_5 PAG_6</span></span>
<span><span class="co">## ASV201       0     0</span></span>
<span><span class="co">## ASV138      11     9</span></span>
<span><span class="co">## ASV11736     0     0</span></span>
<span><span class="co">## ASV207       0    36</span></span>
<span><span class="co">## ASV323       0     0</span></span>
<span><span class="co">## ASV4139      0     0</span></span>
<span><span class="co">## ASV4011     11     9</span></span>
<span><span class="co">## ASV6667     18     0</span></span>
<span><span class="co">## ASV317     598   161</span></span>
<span><span class="co">## ASV11791     0     0</span></span>
<span><span class="co">## ASV712       0     0</span></span>
<span><span class="co">## ASV6543      0     0</span></span>
<span><span class="co">## ASV14        0     0</span></span>
<span><span class="co">## ASV6519      0     0</span></span>
<span><span class="co">## ASV3823      0    29</span></span>
<span><span class="co">## ASV3800     34    23</span></span>
<span><span class="co">## ASV5338      0     0</span></span>
<span><span class="co">## ASV105       0     0</span></span>
<span><span class="co">## ASV117       0    42</span></span>
<span><span class="co">## ASV337       0     0</span></span></code></pre>
<p>Example 3: Filtering with Overall Average Relative Abundance In this
example, we add the condition that an ASV’s overall average relative
abundance must be above 0.005 (0.5%).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"--- Original ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">asv_table_example</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --- Original ASV Count: 40 ---</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_asvs_rel_abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">asv_table_example</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_overall_avg_rel_abundance <span class="op">=</span> <span class="fl">0.005</span> <span class="co"># ASV overall average relative abundance &gt;= 0.5%</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No `metadata_df` or `group_column_name` provided; skipping group-based filtering.</span></span></code></pre>
<pre><code><span><span class="co">## Retained 20 ASVs after applying all filtering conditions.</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n--- Filtered ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtered_asvs_rel_abund</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## --- Filtered ASV Count: 20 ---</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_rel_abund</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">## ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">## ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">## ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">## ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">## ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">## ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">## ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">## ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">## ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">## ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">## ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">## ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">## ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">## ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">## ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">## ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">##          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">## ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">## ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">## ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">## ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">## ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">## ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">## ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">## ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">## ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">## ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">## ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">## ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">## ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">## ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">##          PAG_5 PAG_6</span></span>
<span><span class="co">## ASV201       0     0</span></span>
<span><span class="co">## ASV138      11     9</span></span>
<span><span class="co">## ASV11736     0     0</span></span>
<span><span class="co">## ASV207       0    36</span></span>
<span><span class="co">## ASV323       0     0</span></span>
<span><span class="co">## ASV4139      0     0</span></span>
<span><span class="co">## ASV4011     11     9</span></span>
<span><span class="co">## ASV6667     18     0</span></span>
<span><span class="co">## ASV317     598   161</span></span>
<span><span class="co">## ASV11791     0     0</span></span>
<span><span class="co">## ASV712       0     0</span></span>
<span><span class="co">## ASV6543      0     0</span></span>
<span><span class="co">## ASV14        0     0</span></span>
<span><span class="co">## ASV6519      0     0</span></span>
<span><span class="co">## ASV3823      0    29</span></span>
<span><span class="co">## ASV3800     34    23</span></span>
<span><span class="co">## ASV5338      0     0</span></span>
<span><span class="co">## ASV105       0     0</span></span>
<span><span class="co">## ASV117       0    42</span></span>
<span><span class="co">## ASV337       0     0</span></span></code></pre>
<p>Example 4: Applying All Filtering Criteria Finally, we combine all
filtering criteria to demonstrate the full power of filter_asvs().</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"--- Original ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">asv_table_example</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --- Original ASV Count: 40 ---</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_asvs_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_asvs.html">filter_asvs</a></span><span class="op">(</span></span>
<span>  asv_counts_df <span class="op">=</span> <span class="va">asv_table_example</span>,</span>
<span>  metadata_df <span class="op">=</span> <span class="va">metadata_df_example</span>,</span>
<span>  group_column_name <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>  min_samples_present <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_abs_abundance_value <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_groups_present <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Requires presence in at least 2 groups</span></span>
<span>  min_overall_avg_rel_abundance <span class="op">=</span> <span class="fl">0.01</span> <span class="co"># Requires overall average relative abundance &gt;= 1%</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Retained 20 ASVs after applying all filtering conditions.</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n--- Filtered ASV Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtered_asvs_all</span><span class="op">)</span>, <span class="st">"---\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## --- Filtered ASV Count: 20 ---</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">filtered_asvs_all</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          JRG_1 JRG_2 JRG_3 JRG_4 JRG_5 JRG_6 JJG_1 JJG_2 JJG_3 JJG_4 JJG_5</span></span>
<span><span class="co">## ASV201      16    23    36    27     0    21    38    25    41    31    24</span></span>
<span><span class="co">## ASV138       0     0    12     0     0     0    49    64    45    56    32</span></span>
<span><span class="co">## ASV11736     0     0     0    83     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0     0     5     0     0     0     0     0    41    15     0</span></span>
<span><span class="co">## ASV323       0     0     0    27     0     0    25    26    30    24    66</span></span>
<span><span class="co">## ASV4139     18    29    46    25    50     0    28    31     0    37    55</span></span>
<span><span class="co">## ASV4011      0     0     0     0     0     0     0     0     0    15     0</span></span>
<span><span class="co">## ASV6667      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV317       0     0     0     0     0     0    48    31    26    33    36</span></span>
<span><span class="co">## ASV11791    33    32     0    34     0     0     0    23     0    10     0</span></span>
<span><span class="co">## ASV712      33     0     0    37    43    21     9     8    11    13    12</span></span>
<span><span class="co">## ASV6543      0     0     0     0     0     0    18     0     0     0     0</span></span>
<span><span class="co">## ASV14       37    44    25    29    20     0   105   155   213    65   111</span></span>
<span><span class="co">## ASV6519      0     0     0     0     0     0     0     0     0    41     0</span></span>
<span><span class="co">## ASV3823      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV3800      0     0     0     0     0     0     0    15     0    14     0</span></span>
<span><span class="co">## ASV5338      0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV105       0     0     0     0     0     0    44    52    59    37    62</span></span>
<span><span class="co">## ASV117      38    22    28    19    18    22    62    79    51    81    44</span></span>
<span><span class="co">## ASV337       0     0     0     0     0     0     9    16    24    19    30</span></span>
<span><span class="co">##          JJG_6 TZG_1 TZG_2 TZG_3 TZG_4 TZG_5 TZG_6 PAG_1 PAG_2 PAG_3 PAG_4</span></span>
<span><span class="co">## ASV201       0    36    35    39    50    53    43     0     0     0     0</span></span>
<span><span class="co">## ASV138      31    15    14    12    14     0    12     8     9     8    16</span></span>
<span><span class="co">## ASV11736     0     0     0   121     0   103     0     0     0     0     0</span></span>
<span><span class="co">## ASV207       0    50     0     0    31     0    32    34     0     0     0</span></span>
<span><span class="co">## ASV323      33     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4139     21    20     0    25    25     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV4011      0     0    18    26    14     0     0     0    10     5     8</span></span>
<span><span class="co">## ASV6667      0    23    18    15    18    10    11    16     0     4     7</span></span>
<span><span class="co">## ASV317      25    16     0    26     0     0     0   122   122    79   428</span></span>
<span><span class="co">## ASV11791     0    20     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV712       7     4     0     0     0     3     0     0     0     0     0</span></span>
<span><span class="co">## ASV6543     34     0    49     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV14      102     0     0    76     0     0     0     0     0     0     0</span></span>
<span><span class="co">## ASV6519      0    35    61    87    43    63     0     0     0     0     0</span></span>
<span><span class="co">## ASV3823      0    25    52    37    25    32    29    23    27     0     0</span></span>
<span><span class="co">## ASV3800      0    30    24     0     0    24     0    25    21    41    38</span></span>
<span><span class="co">## ASV5338      5   224    88    61    66   142    60     0     0     0     0</span></span>
<span><span class="co">## ASV105      57     0    34     0     0    32     0     0     0     0     0</span></span>
<span><span class="co">## ASV117      37     0     0     0     0     0     0    34     0     0    15</span></span>
<span><span class="co">## ASV337      30    14    10     0    24     0    14     0     0     0     0</span></span>
<span><span class="co">##          PAG_5 PAG_6</span></span>
<span><span class="co">## ASV201       0     0</span></span>
<span><span class="co">## ASV138      11     9</span></span>
<span><span class="co">## ASV11736     0     0</span></span>
<span><span class="co">## ASV207       0    36</span></span>
<span><span class="co">## ASV323       0     0</span></span>
<span><span class="co">## ASV4139      0     0</span></span>
<span><span class="co">## ASV4011     11     9</span></span>
<span><span class="co">## ASV6667     18     0</span></span>
<span><span class="co">## ASV317     598   161</span></span>
<span><span class="co">## ASV11791     0     0</span></span>
<span><span class="co">## ASV712       0     0</span></span>
<span><span class="co">## ASV6543      0     0</span></span>
<span><span class="co">## ASV14        0     0</span></span>
<span><span class="co">## ASV6519      0     0</span></span>
<span><span class="co">## ASV3823      0    29</span></span>
<span><span class="co">## ASV3800     34    23</span></span>
<span><span class="co">## ASV5338      0     0</span></span>
<span><span class="co">## ASV105       0     0</span></span>
<span><span class="co">## ASV117       0    42</span></span>
<span><span class="co">## ASV337       0     0</span></span></code></pre>
<p>Conclusion This vignette has demonstrated the usage of the
filter_asvs() function from the asvtools package and its versatile
filtering capabilities. By flexibly applying criteria such as
prevalence, absolute abundance, group prevalence, and overall average
relative abundance, you can precisely control the quality control and
preprocessing of your ASV data, laying a solid foundation for subsequent
microbiome data analysis.</p>
<p>Please adjust the parameters of filter_asvs() according to your
specific research needs to achieve optimal filtering results.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yang Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
