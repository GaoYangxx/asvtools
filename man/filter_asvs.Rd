% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_asvs.R
\name{filter_asvs}
\alias{filter_asvs}
\title{根据多重条件筛选 ASV}
\usage{
filter_asvs(
  asv_counts_df,
  metadata_df = NULL,
  group_column_name = NULL,
  min_samples_present = 0,
  min_abs_abundance_value = 0,
  min_groups_present = 0,
  min_overall_avg_rel_abundance = 0
)
}
\arguments{
\item{asv_counts_df}{ASV 计数的数据框，行名为 ASV ID，列名为样本 ID。}

\item{metadata_df}{(可选) 样本元数据的数据框，行名为样本 ID。如果提供，
将根据 \code{group_column_name} 进行分组筛选。默认值为 NULL。}

\item{group_column_name}{(可选) 字符型，\code{metadata_df} 中用作分组依据的列名。
仅当 \code{metadata_df} 提供时有效。默认值为 NULL。}

\item{min_samples_present}{ASV 必须在至少多少个样本中出现（绝对丰度 > 0）。}

\item{min_abs_abundance_value}{ASV 在样本中绝对丰度需要大于的阈值。}

\item{min_groups_present}{ASV 必须在至少多少个 Group 中存在（绝对丰度 > 0）。}

\item{min_overall_avg_rel_abundance}{ASV 在所有样本中的整体平均相对丰度阈值。}
}
\value{
一个经过筛选的 ASV 计数数据框，只包含符合所有条件的 ASV。
}
\description{
此函数根据以下四个条件筛选 ASV：
\enumerate{
\item 在至少 \code{min_samples_present} 个样本中存在 (绝对丰度 > 0)。
\item 在至少 \code{min_samples_present} 个样本中绝对丰度大于 \code{min_abs_abundance_value}。
\item (可选) 在至少 \code{min_groups_present} 个指定 \code{Group} 列的 Group 中存在 (绝对丰度 > 0)。
\item 该 ASV 在所有样本中的整体平均相对丰度大于 \code{min_overall_avg_rel_abundance}。
}
}
\examples{
# 假设已经准备好 b_ASV 和 metadata_df (如前面示例所示)

# 示例 1: 使用所有筛选条件 (包括分组)
# filtered_asvs_full <- filter_asvs(
#   asv_counts_df = b_ASV,
#   metadata_df = metadata_df,
#   group_column_name = "Group", # 假设元数据中有 'Group' 列
#   min_samples_present = 3,
#   min_abs_abundance_value = 3,
#   min_groups_present = 2,
#   min_overall_avg_rel_abundance = 0.0001
# )
# print(filtered_asvs_full)

# 示例 2: 不使用分组筛选 (metadata_df 和 group_column_name 为 NULL)
# filtered_asvs_no_group <- filter_asvs(
#   asv_counts_df = b_ASV,
#   min_samples_present = 3,
#   min_abs_abundance_value = 3,
#   min_overall_avg_rel_abundance = 0.0001 # min_groups_present 会被忽略
# )
# print(filtered_asvs_no_group)
}
