% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_asvs.R
\name{filter_asvs}
\alias{filter_asvs}
\title{Filter ASVs Based on Multiple Criteria}
\usage{
filter_asvs(
  asv_counts_df,
  metadata_df = NULL,
  group_column_name = NULL,
  min_samples_present = 0,
  min_abs_abundance_value = 0,
  min_groups_present = 0,
  min_overall_avg_rel_abundance = 0
)
}
\arguments{
\item{asv_counts_df}{A data frame of ASV counts, with ASV IDs as row names and sample IDs as column names.}

\item{metadata_df}{(Optional) A data frame of sample metadata, with sample IDs as row names.
If provided, grouping filter will be applied based on \code{group_column_name}.
Default is NULL.}

\item{group_column_name}{(Optional) Character string, the name of the column in \code{metadata_df}
to use for grouping. Only effective if \code{metadata_df} is provided.
Default is NULL.}

\item{min_samples_present}{Minimum number of samples an ASV must be present in (absolute abundance > 0).}

\item{min_abs_abundance_value}{Threshold for absolute abundance; an ASV's count in a sample must be
greater than or equal to this value to be considered "present" for
this specific condition.}

\item{min_groups_present}{Minimum number of groups an ASV must be present in (absolute abundance > 0).
Only applicable when \code{metadata_df} and \code{group_column_name} are provided.}

\item{min_overall_avg_rel_abundance}{Threshold for the ASV's overall average relative abundance across all samples.}
}
\value{
A data frame of filtered ASV counts, containing only ASVs that meet all specified criteria.
}
\description{
This function filters ASVs based on four conditions:
\enumerate{
\item Presence in at least \code{min_samples_present} samples (absolute abundance > 0).
\item Absolute abundance greater than \code{min_abs_abundance_value} in at least
\code{min_samples_present} samples.
\item (Optional) Presence in at least \code{min_groups_present} groups
(absolute abundance > 0) defined by the \code{group_column_name}.
\item Overall average relative abundance of the ASV across all samples
is greater than \code{min_overall_avg_rel_abundance}.
}
}
\examples{
# Assuming b_ASV and metadata_df are already prepared (as shown in previous examples)

# Example 1: Use all filtering criteria (including grouping)
# filtered_asvs_full <- filter_asvs(
#   asv_counts_df = b_ASV,
#   metadata_df = metadata_df,
#   group_column_name = "Group", # Assuming 'Group' column exists in metadata
#   min_samples_present = 3,
#   min_abs_abundance_value = 3,
#   min_groups_present = 2,
#   min_overall_avg_rel_abundance = 0.0001
# )
# print(filtered_asvs_full)

# Example 2: Without grouping filter (metadata_df and group_column_name are NULL)
# filtered_asvs_no_group <- filter_asvs(
#   asv_counts_df = b_ASV,
#   min_samples_present = 3,
#   min_abs_abundance_value = 3,
#   min_overall_avg_rel_abundance = 0.0001 # min_groups_present will be ignored
# )
# print(filtered_asvs_no_group)
}
